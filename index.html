<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<meta name="viewport" id="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />


<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>




<script type="text/javascript" charset="utf-8" src="phonegap.js"></script>

<script type="text/javascript" charset="utf-8">

$(document).ready(function(){

var myDB;
//Open Database Connection
document.addEventListener("deviceready",onDeviceReady,false);
function onDeviceReady(){
myDB = window.sqlitePlugin.openDatabase({name: "mySQLite.db", location: 'default'});
}
//Create new table
$("#createTable").click(function(){
    myDB.transaction(function(transaction) {
    transaction.executeSql('CREATE TABLE IF NOT EXISTS phonegap_pro (id integer primary key, title text, desc text)', [],
        function(tx, result) {
            alert("Table created successfully");
        }, 
        function(error) {
              alert("Error occurred while creating the table.");
        });
    });
});

//Insert New Data
$("#insert").click(function(){
  var title=$("#title").val();
  var desc=$("#desc").val();
  console.log(title +""+ desc);
  myDB.transaction(function(transaction) {
        var executeQuery = "INSERT INTO phonegap_pro (title, desc) VALUES (?,?)";             
        transaction.executeSql(executeQuery, [title,desc]
            , function(tx, result) {
                 alert('Inserted');
            },
            function(error){
                 alert('Error occurred'); 
            });
    });
});

//Display Table Data
$("#showTable").click(function(){
  $("#TableData").html("");
  myDB.transaction(function(transaction) {
  transaction.executeSql('SELECT * FROM phonegap_pro', [], function (tx, results) {
       var len = results.rows.length, i;
       $("#rowCount").html(len);
       for (i = 0; i < len; i++){
          $("#TableData").append("<tr><td>"+results.rows.item(i).id+"</td><td>"+results.rows.item(i).title+"</td><td>"+results.rows.item(i).desc+"</td><td><a href='edit.html?id="+results.rows.item(i).id+"&title="+results.rows.item(i).title+"&desc="+results.rows.item(i).desc+"'>Edit</a> &nbsp;&nbsp; <a class='delete' href='#' id='"+results.rows.item(i).id+"'>Delete</a></td></tr>");
       }
    }, null);
  });
});

//Delete Data from Database
$(document.body).on('click', '.delete' ,function(){
  var id=this.id;
  myDB.transaction(function(transaction) {
    var executeQuery = "DELETE FROM phonegap_pro where id=?";
    transaction.executeSql(executeQuery, [id],
      //On Success
      function(tx, result) {alert('Delete successfully');},
      //On Error
      function(error){alert('Something went Wrong');});
  });
});


//Delete Tables
$("#update").click(function(){
  var id=$("#id").text();
  var title=$("#title").val();
  var desc=$("#desc").val()
  myDB.transaction(function(transaction) {
    var executeQuery = "UPDATE phonegap_pro SET title=?, desc=? WHERE id=?";
    transaction.executeSql(executeQuery, [title,desc,id],
      //On Success
      function(tx, result) {alert('Updated successfully');},
      //On Error
      function(error){alert('Something went Wrong');});
  });
});

$("#DropTable").click(function(){
    myDB.transaction(function(transaction) {
        var executeQuery = "DROP TABLE  IF EXISTS phonegap_pro";
        transaction.executeSql(executeQuery, [],
            function(tx, result) {alert('Table deleted successfully.');},
            function(error){alert('Error occurred while droping the table.');}
        );
    });
});

});




</script>

<style>
*{
	font-family: Verdana;
	padding: 0% 1%;
}

body{background-color: #c54245; }

#createTable{background-color: #146b3a; font-weight: bold; font-size: 150%; color: white; width: 100%;}

#insert{background-color: #146b3a; font-weight: bold; font-size: 150%; color: white; width: 100%;}

#showTable	{background-color: #146b3a; font-weight: bold; font-size: 150%; color: white; width: 100%;}

table{background-color: #146b3a;font-weight: bold; font-size: 80%; color: white;}

#DropTable{background-color: #f8b229;font-weight: bold; font-size: 150%; color: white; width: 100%;}

img{
    width: 50%;
    height: auto;
    display: block;
  	margin-left: auto;
  	margin-right: auto;
}


</style>

</head>
<body>
	<center>
<h1>Hermanos y regalos</h1>
	</center>

		<button id="createTable" >Crear Tabla</button>
		<label for="title" style="color: white;">Hermano</label>
			<input type="text" id="title" placeholder="Nombre Hermano" style="width: 100%;">
			<label for="desc" style="color: white;">¿Que le regalaré?</label>	
			<input type="text" id="desc" placeholder="Regalo" style="width: 100%;">
		  
			<br/>
		  <button id="insert" >Insertar renglón</button>
		
		
		<button id="showTable">Mostrar Tabla</button>
		<p></p>
		<table class="table">
			<thead>
				<th>ID</th>
				<th>Title</th>
				<th>Desc</th>
				<th>Action</th>
			</thead>
			<tbody id="TableData">
				
			</tbody>
		</table>
		<p></p>
		<button id="DropTable" >Eliminar la tabla</button>
		<p></p>
		<img src="gift-flat.png">   

	</body>
</html>
